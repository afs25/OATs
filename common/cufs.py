import csv
import logging
import logging.config
import re
import sys

# create logger
logger = logging.getLogger(__name__)
logger.setLevel(logging.DEBUG)
# create console handler and set level to debug
ch = logging.StreamHandler()
ch.setLevel(logging.INFO)
# create formatter
formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
# add formatter to ch
ch.setFormatter(formatter)
# add ch to logger
# logger.addHandler(ch)

###MANUAL FIXES FOR PAYMENT FILES
ZD_NUMBER_TYPOS = {'30878':'50878',
                   '106512': '109512',
                   '116243': '119243',
                   '164388': '164338',
                   }
OA_NUMBER_TYPOS = {'OA 10768':'OA 10468'}
DESCRIPTION2ZD_NUMBER = {
    "OPEN ACCESS FOR R DERVAN'S ARTICLE 'ON K-STABILITY OF FINITE COVERS' IN THE LMS BULLETIN" : '16490',
    'REV CHRG/ACQ TAX PD 04/16;  INV NO:Polymers-123512SUPPLIER:  MDPI AG' : '15589',
    ##INPUT FOR RCUK 2018/19 REPORT
    'Bank chg USD IPO:VE 20632, inv:APC6000011159_COPYRIGHT CLEARANCE _U.VE.VEAG.MAEB.EZZC.': '217113',
}
INVOICE2ZD_NUMBER = {
    ##INPUT FOR RCUK 2018/19 REPORT
    'nutrients-364921/CR': '236449',
    ##INPUT FOR RCUK 2017 REPORT
    'APC502145176':'48547',
    'P09819649':'28975',
    'Polymers-123512':'15589',
    'Polymers-123512/BANKCHRG':'15589',
    '9474185' : '18153',
    ##INPUT FOR COAF 2017 REPORT
    '19841M2' : '87254',
    '20170117' : '50542',
    '94189700 BANKCHRG' : '47567',
    ## From LST_AllFinancialData_V3_20160721_Main_Sheet.csv
    '15966557': '46',
    '15966487': '47',
    'W1205391': '127',
    'E07384303': '144',
    '3203800048035': '227',
    'E07362709': '250',
    'W1196850': '264',
    'W1189033': '278',
    '9139671-1': '322',
    'W1189095': '328',
    '3043982': '373',
    '15976119': '396',
    'RLNK501045055': '477',
    # TODO: Try to fix this: 'Reimbursement': '498',
    'PAB77845': '506',
    '10089CV4': '520',
    'E07367790': '526',
    'W1191120': '534',
    '15985335': '541',
    '6106087181': '572',
    'PK 791317': '587',
    '15985339': '647',
    '6106087617': '654',
    '8481445': '659',
    'RLNK501066042': '714',
    '301549': '716',
    '2936009205': '736',
    '7093201': '739',
    '15985877': '767',
    '90308313': '775',
    'E07334998': '777',
    'E07330938': '795',
    '9220555-1': '811',
    '734868': '813',
    '15985866': '818',
    'PAB92944': '823',
    '10036CV3': '824',
    'NA 813984': '848',
    'W1197221': '875',
    'E07330962': '885',
    '6106088510': '886',
    'PAB78812': '888',
    '6106088552': '889',
    'E07367102': '890',
    'Sustainability-34895': '901',
    '1864192': '918',
    'ACP-PUC-2013-463': '925',
    '2936007667': '938',
    # TODO: Try to fix this: 'Reimbursement': '946',
    'W1192392': '959',
    'RH 780743': '967',
    '15992022': '979',
    'W1226983': '1033',
    'W1193751': '1045',
    'PJ 793584': '1053',
    'W1194113': '1063',
    '15991336': '1071',
    'W1193160': '1076',
    '9270067-1': '1087',
    'RLNK501154090': '1155',
    'W1194316': '1159',
    'W1194256': '1175',
    'W1194734': '1210',
    '9910957': '1212',
    'SL8674': '1213',
    'E07374764': '1219',
    '9181950-1': '625',
    '67742': '252',
    'XF 789594': '1225',
    'JGV056176-0': '1236',
    '6106091302': '1249',
    'E07390710': '1262',
    'PAB83969': '1271',
    'E070466528': '1308',
    'ACP-PUC-2013-536': '1325',
    'W1195559': '1330',
    'RLNK501088137': '1368',
    'E07385069': '1374',
    '2625391': '1375',
    'W1197468': '1385',
    '6106092070': '1391',
    'OP/0009594': '1395',
    '10044CVS': '1396',
    'E07384069': '1400',
    'W1187236': '1428',
    'W1197035': '1431',
    '038393': '1433',
    '6106092724': '1437',
    'W1195840': '1442',
    '2936005429': '1448',
    '9345940-1': '1492',
    '2936013612': '1528',
    'MA 789783': '1553',
    'AD1040443': '1574',
    '91293187': '1608',
    '734920': '1614',
    'W1198274': '1638',
    '10254CV3': '1639',
    'W1198283': '1640',
    'RC 789426': '1660',
    '3046772': '1672',
    'SL8902': '1673',
    '2949252': '1636',
    'PAB85709': '1677',
    'MIcromachines-41268': '1684',
    'W1199387': '1699',
    '16078961': '1727',
    'W1195683': '100',
    '10105CV4': '1739',
    'W1198188': '1748',
    'W1198275': '1749',
    '6106094608': '1752',
    '2013-0015403-2': '1764',
    'E07424369': '1767',
    'W1198537': '1768',
    'RLNK501122525': '1777',
    '16101744': '1795',
    '2936014419': '1800',
    '10106CV5': '1810',
    'CELR-37622-0': '1857',
    'E07434395': '1861',
    '16084873': '1866',
    'E07544628': '1870',
    '2135287': '1871',
    'RLNK501131470': '1879',
    'RLNK501134445': '1899',
    'W1217879': '1903',
    '16084886': '1915',
    '7530479': '1918',
    '6106096175': '1928',
    '10139CV2': '1939',
    'W1223383': '1942',
    'ACP-PUC-2013-733': '1947',
    'E07503089': '1949',
    '2936015946': '1999',
    '16093548': '2003',
    'E07473364': '2007',
    '16106659': '2014',
    '91295808': '2030',
    'TC-PUC-2013-186': '2062',
    'W1201204': '2063',
    'I0056491': '2072',
    'I0056631': '2080',
    '2627402': '2088',
    '6665111': '2089',
    '6106097707': '2090',
    'W1202477': '2102',
    '7097450': '2104',
    '119278': '2105',
    '2013-0014566-6': '2113',
    '6106000517': '2128',
    '8012072': '2131',
    'I0056763': '2145',
    '2936024089': '2146',
    '10184CV9': '2153',
    'SGM-JGV059808-0': '2159',
    '947176333': '2164',
    'RLNK501173932': '2165',
    'E07560535': '2168',
    'PAB92413': '2170',
    '2936030506': '2178',
    'E07521792': '2182',
    '10241CV5': '2198',
    '803273': '2197',
    '16100990': '2202',
    'E07544621': '2208',
    '1227313': '2211',
    'W1196078': '2212',
    'W1197325': '2213',
    'PAB90797': '2214',
    '2013-001-4507-3': '2225',
    '16101726': '2227',
    '16101728': '2228',
    '1600104595': '2230',
    '803255': '2236',
    '803229': '2239',
    'W1218454': '2252',
    'PAB94255': '2254',
    '4839842': '2260',
    'AJCN-3577-0': '2264',
    '8012118': '2267',
    '5097403': '2275',
    'PAB94557': '2280',
    '16084195': '2281',
    'W1205516': '2283',
    'RLNK501180870': '2289',
    '16131216': '2292',
    '6106001441': '2307',
    '000158243': '2308',
    'W1205847': '2309',
    'SL9323': '2310',
    '124817': '2311',
    'E07749804': '2316',
    'W1207296': '2318',
    'W1207160': '2323',
    '16104849': '2329',
    'E07749747': '2330',
    'SI026483': '2338',
    '7096443': '2347',
    'E07653745': '2351',
    '6106003644': '2352',
    '155846OI': '2359',
    '4940678': '2361',
    '2936024909': '2363',
    'W1209532': '2370',
    'PC 813732': '2376',
    'MA 187175': '2378',
    '16106690': '2380',
    '16106700': '2381',
    '16105380': '2388',
    '91296068': '2390',
    'W1209350': '2403',
    'SGM-VIR060624-0': '2407',
    '4041032': '2417',
    '6106003550': '2423',
    'RSTB-2013-0163.R1': '2425',
    'W1209533': '2431',
    'W1210920': '2433',
    '16105770': '2437',
    'SL9689': '2439',
    '10364CV7': '2471',
    'W1210889': '2472',
    '4040947': '2476',
    'W1210188': '2477',
    '6106006009': '2514',
    '7099816': '2522',
    '7596354': '2526',
    'E07772332': '2528',
    'W1214871': '2530',
    'PAB98669': '2533',
    'Reimbursement': '2540',
    '157818OI': '2546',
    'E07763109': '2549',
    '7855862': '2555',
    'W1211191': '2558',
    '9709728': '2572',
    '2936034661': '2574',
    'E07762657': '2576',
    'BE-15151-0': '2579',
    'W1212309': '2591',
    '7098099': '2595',
    '8719074': '2596',
    '735177': '2599',
    '9709729': '2601',
    'INVOTH-000634': '2610',
    'FJ 2014-2013-242727': '2615',
    'W1212515': '2617',
    '16122105': '2618',
    '039121': '2619',
    '8719077': '2621',
    'W1237690': '2624',
    '6106007000': '2626',
    'W1212514': '2628',
    'E07774864': '2634',
    ' Â£648.00 ': '2653',
    '16121678': '2662',
    '140303115656-8649': '2663',
    'W1213239': '2664',
    '430479': '2673',
    '10419473': '2678',
    'W1220720': '2699',
    '2936039280': '2730',
    '2517349': '2746',
    '10382213': '2755',
    '10745CV6': '2776',
    'E07986025': '2778',
    '6106009589': '2795',
    '2013-00181517-2': '2803',
    'I0059391': '2806',
    'W1215305': '2807',
    '7098098': '2814',
    '10578CV5': '2815',
    'W1215221': '2825',
    'SL 10152': '2830',
    'E07859593': '2854',
    'W1215323': '2855',
    'AD1041889': '2859',
    '16123992': '2861',
    '132990': '2862',
    'XF 809735': '2863',
    'RLNK501229332': '2867',
    '6106011859': '2882',
    '6106010376': '2884',
    'SL10154': '2888',
    '16132097': '2891',
    '2014-13-231084': '2894',
    '91298475': '2896',
    '735261': '2910',
    'AJCN-3923-0': '2924',
    '816269': '2936',
    '1680058': '2944',
    '16134551': '2951',
    'W1216886': '2957',
    '2936042138': '2958',
    'E07962511': '2964',
    'LB 820774': '2972',
    '16130929': '2973',
    'PAB105146': '2974',
    'W1241431': '2978',
    'SL10153': '2988',
    'PAB105317': '2992',
    'E07992686': '3007',
    'PH 819559': '2917',
    'PH 814166': '2917',
    'PH 814133': '2917',
    'PH 814136': '2917',
    'W1219802': '3017',
    '3762274': '3030',
    '6106130460': '3033',
    'SL10155': '3040',
    'AUTH-1007': '3046',
    'W1219530': '3047',
    '2936058883': '3059',
    'SGM-VIR063461-0': '3063',
    '6106013436': '3064',
    'SL10179': '3075',
    '2014-0021146-2': '3078',
    '2014-0019317-3': '3080',
    '947204848': '3089',
    'W1221426': '3096',
    '309832': '3100',
    'W1223796': '3108',
    'E08003820': '3118',
    '000165608': '3123',
    '16139253': '3124',
    '10592CV9': '3155',
    'W1219486': '3159',
    '7098818': '3170',
    'W1220150': '3171',
    '2936060249': '3173',
    'PAB107624': '3176',
    '6106015868': '3179',
    '1062685': '3181',
    'E07994801': '3184',
    '11091CV5': '3185',
    'RC 819580': '3197',
    '5734802' : '3198',
    '8130918' : '3198',
    'RLNK01282936': '3200',
    'W1220822': '3201',
    '161530OI': '3202',
    '160763OI': '3211',
    'W1224894': '3215',
    'W1229770': '3216',
    'PAB108791': '3222',
    '2936059396': '3223',
    'W1221455': '3224',
    '2936060848': '3229',
    '1000330665': '3234',
    '1000330672': '3234',
    '16156782': '3236',
    'SL10365': '3237',
    '129403': '3244',
    # This is probably a typo in old payments spreadsheet LST_AllFinancialData_V3_20160721_Main_Sheet.csv; This
    # invoice number Matches ZD ticket 3308 (match verified): 'E08085661': '3248',
    'RLNK501337494': '3250',
    '7101250': '3253',
    '4043268': '3258',
    'W1223392': '3261',
    'W1223194': '3262',
    '6106018307': '3265',
    'Maney-Track-140507121233-49': '3267',
    '7550000867': '3268',
    'RLNK501290120': '3272',
    'PM 822725': '3273',
    'W1224335': '3275',
    'W1223774': '3276',
    'W1224516': '3279',
    '7796499': '3282',
    '2936059871': '3290',
    '7977400': '3291',
    '8948442': '3295',
    'E08032947': '3297',
    '8991194': '3298',
    '7796507': '3304',
    'W1278997': '3306',
    'W1227394': '3330',
    '735369': '3137',
    'SL10352': '3336',
    '6106016987': '3337',
    'RLNK501302575': '3342',
    '2936073899': '3343',
    'E08036507': '3348',
    '8805768': '3350',
    '8096668': '3352',
    '2014-0A-221': '3359',
    '735399': '3361',
    '735484': '3368',
    '947196128': '3371',
    'E08052390': '3395',
    '9501304': '3410',
    'RG 859363': '3411',
    'E08001947': '3277',
    '1-4524034101': '3419',
    '6106019614': '3446',
    'PAB112087': '3451',
    '8805773': '3454',
    'W1225885': '3459',
    '16162379': '3462',
    '2936060913': '3468',
    'PAB112398': '3522',
    'W1225374': '3524',
    '9367038': '3531',
    'E08135732': '3534',
    '9367036': '3537',
    'E08053944': '3550',
    'E08082328': '3564',
    '4648401': '3585',
    '2936060206': '3588',
    '2014-0021198-6': '3589',
    'E08069095': '3594',
    '13110': '3597',
    'SL10943': '3598',
    'W1228748': '3601',
    'E08068118': '3603',
    '2936060925': '3609',
    'W1229089': '3611',
    '162392OI': '3616',
    'W1229614': '3617',
    'E08183720': '3631',
    '4044562': '3644',
    'E08086332': '3645',
    '8988157': '3646',
    'W1227790': '3651',
    '947197008': '3656',
    'E08262523': '3661',
    '133491': '3663',
    'JN-8105-0': '3666',
    'PAB113827': '3677',
    'RLNK501337791': '3697',
    'PAB115034': '3698',
    '2936064340': '3702',
    'E08088217': '3704',
    '16175795': '3709',
    '1-4744058513': '3710',
    'RLNK501333299': '3711',
    '7100819': '3716',
    '10828CV9': '3719',
    '10818CV6': '3723',
    'AJCN-3815-0': '3728',
    '6106100322': '3732',
    'PAB115368': '3744',
    '1062644': '3746',
    'W1229916': '3755',
    '134671': '3761',
    'W1230152': '3766',
    'W1230046': '3777',
    'PJ 850786': '3780',
    '646504': '3803',
    'W1231327': '3806',
    'W1231613': '3818',
    'TC-PUC-2014-167': '3819',
    'W1239810': '3821',
    '26109026': '3826',
    'SL10970': '3834',
    '2028554': '3840',
    '1061783': '3861',
    '4319270': '3870',
    '16176988': '3895',
    '2936061913': '3896',
    '2936061466': '3899',
    '000185869': '3912',
    '91304007': '3922',
    '163001OI': '3929',
    '162516OI': '3876',
    '134695': '3953',
    'RLNK501362669': '3964',
    '1-5369855527': '3965',
    'W1236291': '3982',
    '91303893': '3997',
    'W1233185': '4017',
    'W1233007': '4022',
    '135621': '4027',
    'PAB119338': '4042',
    '7342345': '4044',
    '2936061576': '4046',
    '735575': '4052',
    'E08155194': '4058',
    '735595': '4064',
    'MA 838636': '4079',
    'PAB118782': '4080',
    'W1233699': '4091',
    '735793': '4102',
    'PAB118742': '4108',
    '1-5016726682rev': '4110',
    'CSBJ-S303': '4113',
    'PN 881216': '4117',
    'W1237822': '4130',
    'W1237821': '4131',
    'E08161344': '4134',
    '8450583': '4140',
    '4838393': '4141',
    '166820OI': '4143',
    '2936063377': '4144',
    'APC501374139': '4149',
    '6106101809': '4151',
    'W1234635': '4157',
    '269580': '4162',
    '1-504322737rev': '4164',
    '2014-14-259473': '4166',
    'APC501377611': '4168',
    'W1235272': '4172',
    '2014-0025163-9': '4177',
    '4932615': '4178',
    '6106115117': '4216',
    'SL12352': '4223',
    '201402486': '4241',
    '6665137': '4254',
    '2936068170': '4255',
    '8650427': '4264',
    '4046525': '4274',
    '11160CV1': '4282',
    'SJ 876911': '4288',
    'APC501388781': '4291',
    'nutrients-63743': '4292',
    'E08186965': '4293',
    'W1238757': '4302',
    'PJ844870': '4311',
    'W1237974': '4313',
    '5246121': '4323',
    'PAB123173': '4332',
    '7565617': '4350',
    'W1238345': '4373',
    'SL11932': '4385',
    '7060916': '4388',
    '1-5781111675': '4390',
    'W1245910': '4401',
    '947213444': '4403',
    'W1238347': '4420',
    'RLNK501399253': '4425',
    'APC501406694': '4426',
    # This is an aggregated invoice containing charges for several papers. Fortunately, it is broken down in several
    # transactions in CUFS, each linked to individual tickets. We shouldn't need to recourse to this dictionary
    # for this particular invoice: 'SE 856646': '4428', 'SE 856646': '4762', 'SE 856646': '4890', 'SE 856646': '6393',
    'JNeurosci00449': '4440',
    'W1241442': '4444',
    '231014 WL': '4452',
    '8988758': '4458',
    '138898': '4471',
    'PAB122572': '4477',
    'W1241673': '4480',
    'SL11494': '4481',
    'SL11493': '4482',
    'PS844698': '4485',
    'W1241830': '4488',
    'E08560958': '4494',
    '2014-0027421-2': '4505',
    '000194436': '4510',
    '7872533': '4527',
    '7872534': '4528',
    'W1239442': '4529',
    'W1245495': '4534',
    'E08251546': '4537',
    'MA 843280': '4540',
    '2936069208': '4546',
    'SL11513': '4550',
    '6106104826': '4551',
    'PAB123930': '4552',
    'PM 843418': '4553',
    'RH 857986': '4556',
    'PAB123649': '4572',
    'W1243031': '4578',
    '000203067': '4583',
    'W1239987': '4591',
    '91303588': '4603',
    '8310959': '4607',
    'W1239811': '4610',
    'W1239982': '4615',
    '7627786': '4631',
    '0000000045': '4632',
    'DB-73856-0': '4669',
    'APC501417706': '4675',
    'W1243117': '4681',
    '138065': '4692',
    'APC501422475': '4729',
    'FSO-52475/1': '4741',
    'APC501421332': '4743',
    'CELR-38323-0': '4744',
    'W1243348': '4765',
    '8028056': '4772',
    'RN 853024': '4774',
    '11257CV8': '4775',
    'RN 848697': '4776',
    'RN879420': '4777',
    'RN 884696': '4779',
    '7101761': '4786',
    '2936067195': '4797',
    'PAB124475': '4801',
    'E08249386': '4809',
    'PAB125156': '4818',
    'PR 847369': '4831',
    'PS 855304': '4833',
    'W1243346': '4851',
    '2936066100': '4864',
    'W1241978': '4869',
    '165091OI': '4871',
    'W1239806': '4895',
    '8023036': '4926',
    '8023067': '4929',
    '11149CV2': '4931',
    'APC501431631': '4932',
    'E08263186': '4940',
    '6106108767': '4950',
    '91303857': '4953',
    'APC501514971': '4956',
    '201403161': '4959',
    '9360484': '4961',
    'W1243713': '4964',
    '138825': '4965',
    'SL11726': '4966',
    '11251CV3': '4971',
    '31825': '4976',
    'W1244792': '4992',
    '4047796': '4997',
    'W1242509': '5000',
    'W1248472': '5007',
    '2936066675': '5020',
    'W1243061': '5029',
    'W1243332': '5030',
    '6106110628': '5036',
    'APC50143474': '5038',
    'W1245743': '5047',
    'LUP 3682': '5051',
    'SL12249': '5052',
    'W1243528': '5058',
    'APC501437270': '5061',
    'W1243529': '5081',
    '1008': '5089',
    'ManeyTrack-150305193739-0': '5094',
    '150108UK-rd-zt': '5097',
    'APC501515934': '5099',
    '000212782': '5102',
    '506193': '5107',
    '2015 OA 5180': '5121',
    '1360344': '5126',
    '7223450': '5142',
    '1064264': '5195',
    'W1244938': '5219',
    'E08342278': '5222',
    '947207737': '5232',
    '721735': '5257',
    '4004783': '5271',
    'E08514489': '5297',
    'RN 879672': '5327',
    'PNAS-120796-0 B': '5334',
    '3729272': '5382',
    'SL11801': '5384',
    'SL11748': '5388',
    'W1249097': '5389',
    '6106112460': '5413',
    '977065': '5418',
    '6106110972': '5425',
    'AJCN-3993-0': '5427',
    'SL11803': '5434',
    '2936067702': '5436',
    'CELR-38340-0': '5437',
    '5003020': '5445',
    '0000203398': '5449',
    '1-5365940016': '5454',
    '6106110814': '5457',
    'APC501453037': '5466',
    '2014-14-263004': '5478',
    '6106115356': '5484',
    '2936066441': '5489',
    '1360345': '5490',
    'E08329022': '5494',
    'W1246975': '5499',
    'W1247716': '5509',
    'PAB127102': '5523',
    'E08329971': '5531',
    'APC501447139': '5532',
    '4048057': '5535',
    '1063751': '5541',
    'W1245875': '5546',
    '947208066': '5555',
    'W1247475': '5556',
    '210670': '5563',
    '11379CV5': '5564',
    'W1246359': '5566',
    '3381975': '5567',
    'W1245909': '5581',
    '735816': '5583',
    'W1266703': '5584',
    '2819631': '5590',
    'W1246972': '5595',
    'W1251804': '5598',
    'W1246594': '5602',
    '943188688': '5613',
    'PAB128169': '5622',
    'AMM004': '5635',
    'SL11861': '5643',
    '11283CV0': '5644',
    '3306699': '5657',
    'SL11828': '5659',
    'SL11870': '5663',
    '11355CV0': '5665',
    'RLNK501497360': '5667',
    '6106111844': '5671',
    'RG 881271': '5676',
    '8036714': '5678',
    'E08346288': '5687',
    'DB-73919-0': '5696',
    'APC501555404': '5703',
    '5041561': '5708',
    'W1315547': '5711',
    '4359327': '5716',
    '1124CV0': '5718',
    '4048508': '5729',
    'RG 860771': '5731',
    'W1267870': '5736',
    'E08347180': '5744',
    'SL11928': '5748',
    '2936068166': '5749',
    'W1247333': '5754',
    '4048298': '5756',
    '5042184': '5763',
    'SL12078': '5764',
    '3239045': '5780',
    'W1250986': '5784',
    '2900055': '5794',
    '1000421224': '5796',
    '167307OI': '5801',
    '11456CV5': '5823',
    'RLNK501465910': '5834',
    '11257CV9': '5840',
    '4048506': '5843',
    '2389903': '5848',
    'E08565120': '5855',
    '2936067341': '5871',
    '11324CV0': '5872',
    'E08592789': '5873',
    'W1260841': '5875',
    'APC501474786': '5876',
    '1369': '5881',
    '1368': '5883',
    '943179899': '5884',
    '947210019': '5901',
    '6106112816': '5880',
    'E08543574': '5909',
    '2936067342': '5910',
    '11298CV3': '5917',
    '1125CV6': '5921',
    'PK 852580': '5894',
    'W1250984': '5924',
    'E08743516': '5932',
    'RLNK501473177': '5953',
    '4971234': '5955',
    'W1250261': '5961',
    'W1250260': '5962',
    '000238443': '5966',
    '3076355': '5973',
    'W1250253': '5976',
    '2936067921': '5987',
    'PH 854464': '5995',
    '8026761': '5998',
    'W1249094': '5999',
    'APC501481657': '6039',
    '11369CV1': '6042',
    '943186781': '6048',
    'APC501572074': '6055',
    '5041621': '6059',
    '11276CV3': '6064',
    'PAB128667': '6085',
    '6106117225': '6102',
    'w1252143': '6105',
    '5085200': '6106',
    '2936068580': '6107',
    '3395895': '6108',
    'W1252121': '6122',
    'PM 855262': '6125',
    '11352CV1': '9693',
    '8034252': '6132',
    '1-5535824487': '6134',
    '16707OI': '6135',
    'I0066262': '6138',
    '177091OI': '5979',
    'W1253425': '6152',
    'ACP-PUC-2015-20': '6155',
    'W1254727': '6159',
    '852410': '6072',
    '4969057': '6174',
    'AD1042436': '6177',
    'APC501487771': '6184',
    'W1252724': '6201',
    '9000662150': '6202',
    '6106117089': '6204',
    'W1253962': '6211',
    'W1269391': '6213',
    'W1260565': '6218',
    '2936068237': '6239',
    'PK 854790': '6240',
    '2936067759': '6250',
    '5041765': '6258',
    '4622135': '6261',
    '8035094': '6263',
    '5649664': '6264',
    '171196OI': '6266',
    'SL12132': '6282',
    'APC501486822': '6288',
    'E08085661': '3308',
    '4693156': '6298',
    '3509826': '6306',
    'APC501490536': '6309',
    '11357CV5': '6312',
    'W1256245': '6322',
    '3791045': '6331',
    '6961081': '6332',
    'SL12174': '6334',
    '4969041': '6335',
    '947212355': '6336',
    'W1252317': '6338',
    '6106117174': '6339',
    'W1256483': '6356',
    'W1254813': '6384',
    '854049': '6389',
    'AJCN-4049-0': '6391',
    '947213920': '6402',
    'W1254354': '6415',
    '943183659': '6418',
    'PJ 853936': '6429',
    '5649963': '6430',
    '7828': '6433',
    'W1254764': '6435',
    'W1256484': '6436',
    'APC501521370': '6440',
    'W1255424': '6452',
    '042787': '6465',
    '2014-0029633-3': '6468',
    'W1255106': '6482',
    '11408CV2': '6488',
    '5040309': '6498',
    '5040308': '6500',
    '947218557': '6508',
    '170074OI': '6523',
    'W1255673': '6524',
    '7550001408': '6526',
    # This invoice aggregates payments for two tickets, so it will be have to be dealt with elsewhere:
    # 'SC 856123': '6380', 'SC 856123': '6393',
    '11443CV7': '6539',
    'PAB130870': '6544',
    'JN-RM-1150-14R2': '6547',
    'PAB131256': '6550',
    'W1255682': '6554',
    'PAB130929': '6522',
    'PM 853672': '6279',
    'PM 855245': '6562',
    'SL 12255': '6567',
    '10860731-1': '6581',
    '11412CV4': '6587',
    '2936069053': '6589',
    '2014-0028686-3': '6595',
    'PJ 857585': '6596',
    '5560515': '6598',
    '0000203299': '6599',
    '11631CV6': '6600',
    '2014-0030033-3': '6603',
    '170149OI': '6604',
    '2936068581': '6614',
    '5040402': '6624',
    'E08629866': '6654',
    'APC501563278': '6656',
    'APC501563208': '6657',
    '5841376': '6659',
    '735957': '6661',
    '11411CV6': '6668',
    '5653653': '6672',
    '11641CV5': '6678',
    '11447CV6': '6681',
    'CELR-38465-0': '6689',
    '8032604': '6696',
    'SL12276': '6714',
    'PK 859209': '6719',
    '6986114': '6725',
    'APC501510874': '6729',
    'NA 858068': '6732',
    '91306641': '6734',
    'RLNK501515705': '6735',
    '2936070818': '6740',
    '173250OI': '6745',
    'PAB131891': '6747',
    'RLNK501530773': '6750',
    '6106120287': '6752',
    'PAB132013': '6761',
    'SL12367': '6766',
    'SH 85617': '6393',
    'PAB93302': '6770',
    'PAB132089': '6778',
    'RLNK501523921': '6802',
    'W1262211': '6804',
    '172303OI': '6808',
    '2936070308': '6812',
    'SL12318': '6814',
    'JP 116892': '6835',
    'E08639073': '6849',
    'JP 116822': '6771',
    'W1259464': '6856',
    'E08639402': '6857',
    'PS 857247': '5856',
    'APC501518126': '6875',
    '6106121324': '6881',
    'E08818991': '6886',
    'E08663306': '6887',
    'PK 858628': '6888',
    '947214435': '6894',
    'W1259802': '6906',
    '2014-0029266-3': '6908',
    'SL 12319': '6915',
    '000212998': '6920',
    'APC501522444': '6923',
    '11462CV1': '6926',
    '6106121363': '6927',
    'W1260267': '6931',
    'W1261275': '6940',
    'APC501532624': '6943',
    '171972OI': '6949',
    '7318555': '6961',
    'JP116873': '6968',
    'APC501541838': '6970',
    'W1261048': '6985',
    'W1262212': '6986',
    '6106122187': '6997',
    'E08677569': '7002',
    'E08677644': '7003',
    '15-071': '7004',
    '6106122288': '7006',
    'E08684460': '7011',
    '000227924': '7012',
    'APC501526545': '7019',
    '7802793': '7025',
    'PAB133429': '7026',
    'W1262049': '7045',
    '7457895': '7056',
    'APC501532016': '7060',
    'E08697264': '7066',
    'W1261704': '7074',
    'E08700098': '7077',
    'W1272439': '7078',
    '5041620': '7080',
    'PAB133572': '7083',
    'E08705674': '7087',
    'W1261706': '7089',
    '6106122471': '7090',
    'RLNK501542043': '7091',
    '1-5796437473': '7096',
    '000214925': '7104',
    '1-5870523003': '7114',
    'PAB132278': '7115',
    '2015-0033293-4': '7123',
    'JN-RM-4259-14R1': '7124',
    '172524OI': '7135',
    '5041623': '7139',
    'W1263226': '7150',
    '200/0120483': '7155',
    '6106122603': '7162',
    '5041622': '7163',
    '735996': '7171',
    '6106122593': '7177',
    'W1262470': '7179',
    'E08710664': '7185',
    'W1262695': '7189',
    '8176089': '7196',
    '8003352': '7198',
    '000214584': '7199',
    '11493CV7': '7072',
    '6172996': '7206',
    'PK 862460': '7209',
    '8990336': '7220',
    'W12636696': '7221',
    'viruses-73783': '7229',
    '8031490': '7230',
    '11518CV9': '7235',
    '8989773': '7245',
    'APC501560110': '7249',
    'SL12739': '7250',
    'APC501541789': '7258',
    '11537CV0': '7268',
    '6106126190': '7275',
    'RLNK501543425': '7276',
    '9461029': '7279',
    'W1267955': '7280',
    '3402544': '7281',
    '11536CV9': '7283',
    'E08748670': '7298',
    'W1264936': '7302',
    '3635497': '7306',
    'APC501602083': '7310',
    'W1265160': '7312',
    '0000000097': '7324',
    '9456897': '7330',
    'W1264940': '7332',
    'RLNK501549054': '7336',
    'APC501551005': '7338',
    'W1265164': '7347',
    'OP/0010449': '7349',
    '389568': '7355',
    '11720CV6': '7361',
    '2936071229': '7366',
    'PAB134631': '7368',
    'PAB129912': '7370',
    'RLNK50155387': '7377',
    'PAB132596': '7386',
    'W1268192': '7391',
    '11863CV7': '7392',
    '2936071851': '7396',
    '173231OI': '7400',
    'APC501560853': '7404',
    '000216836': '7412',
    'W1266702': '7445',
    '2936071114': '7455',
    '9944920': '7458',
    '000215941': '7463',
    'APC501554921': '7499',
    '2584032': '7511',
    '790102': '7515',
    '172851OI': '7523',
    '91307563': '7525',
    '173169OI': '7529',
    '17289OI': '7531',
    '6106126455': '7536',
    'APC501556618': '7537',
    'AJCN-4113-0': '7539',
    '173365OI': '7543',
    '174719OI': '7547',
    '11599CV0': '7548',
    '11625CV2': '7552',
    'AJCN-4096-0-1': '7555',
    '11601CV5': '7556',
    'ACP-PUC-2015-243': '7559',
    'PAB137069': '7561',
    'W1267691': '7580',
    '91307575': '7586',
    'W1267113': '7591',
    '11598CV1': '7592',
    'W1267658': '7595',
    'APC501561017': '7602',
    '11598CV2': '7604',
    '30514579': '7605',
    'W1268630': '7606',
    '173838OI': '7610',
    'W1279678': '7614',
    '947220000': '7615',
    'RH 867698': '7621',
    '43460': '7626',
    '11606CV4': '7627',
    '11621CV5': '7629',
    '2014-0030834-5': '7632',
    'W1268146': '7657',
    'W1270045': '7665',
    'W1268780': '7672',
    '2936072310': '7676',
    '2929144': '7693',
    '11653CV5': '7698',
    '2936071399': '7709',
    'E08812830': '7713',
    'CELR-38644-0': '7719',
    'E08879616': '7720',
    '174223OI': '7723',
    '7717': '7727',
    'APC501568295': '7732',
    '2810782': '7745',
    '7084962': '7762',
    'W1269158': '7765',
    'RLNK501574827': '7776',
    '8038692': '7778',
    '5042631': '7783',
    '1194758': '7786',
    '6106127356': '7797',
    '174609OI': '7799',
    'APC-04-15-01': '7809',
    'W1271221': '7816',
    'PAB136243': '7818',
    'W1270923': '7825',
    '11744CV5': '7831',
    '91308852': '7833',
    '2226587': '7837',
    'W1270126': '7859',
    'APC501601154': '7863',
    '1194870': '7868',
    '736297': '7872',
    '043614': '7874',
    '736105': '7903',
    'E08855011': '7904',
    '1764822': '7914',
    'APC501580634': '7918',
    'E08957400': '7919',
    '2936073420': '7941',
    'W1272440': '7946',
    'AJCN-4159-0': '7952',
    'PAB135012': '7953',
    '2460664': '7956',
    'APC501582132': '7961',
    '6106128783': '7978',
    '6106128806': '7979',
    'APC501584917A': '7980',
    '2210919': '7981',
    '2210869': '7982',
    'APC501583908': '7996',
    'W1273944': '7999',
    'E09019031': '8002',
    '736241': '8022',
    '2936072311': '8025',
    '5044169': '8028',
    '736117': '8034',
    '11685CV5': '8035',
    'PAB142209': '8037',
    'W1274185': '8038',
    '11728CV1': '8040',
    '11689CV0': '8041',
    '174871OI': '8043',
    'W1272302': '8052',
    'W1276682': '8053',
    'PAB138844': '8061',
    'APC501587326': '8063',
    'E09248874': '8077',
    '2461546': '8078',
    '175399OI': '8081',
    '3050487': '8083',
    '943196278': '8118',
    '0000000126': '8138',
    'APC501591358A': '8141',
    'PAB152009': '8144',
    'W1275801': '8148',
    'E08989245': '8157',
    'W1274668': '8171',
    '5043369': '8184',
    'APC501608470': '8193',
    '174461OI': '8201',
    'W1277416': '8202',
    'E08923680': '8203',
    'E08923669': '8204',
    '000222297': '8206',
    '2936076168': '8215',
    '7329216': '8221',
    '6041794': '8222',
    '11726CV6': '8225',
    '2936073075': '8239',
    '91308834': '8246',
    '175629OI': '8248',
    '11738CV5': '8249',
    '11745CV4': '8250',
    '736121': '8256',
    '4458613': '8263',
    '1-6129246141': '8267',
    '11931CV5': '8270',
    '6798101': '8271',
    'W1274848': '8272',
    'PAB143618': '8275',
    'OP/0010669': '8285',
    '5941282': '8286',
    '11773CV1': '8287',
    '6106130631': '8294',
    '11742CV7': '8296',
    '4458659': '8304',
    '91317673': '8317',
    '175755OI': '8318',
    'LUP 3850': '8321',
    '176142OI': '8324',
    'E08940500': '8325',
    'W1274693': '8326',
    '2936073680': '8330',
    'APC501608126': '8335',
    'W1285958': '8348',
    'W1276113': '8365',
    'W1275161': '8367',
    'E09221403': '8373',
    '4838804': '8375',
    '11763CV8': '8384',
    '6106131598': '8386',
    '0000000138': '8387',
    '11832CV4': '8394',
    '6106131619': '8395',
    '6106130673': '8402',
    'sustainability-86472': '8403',
    '947222291': '8416',
    '5268518': '8422',
    'KA 869675': '7954',
    '8037868': '8439',
    'E09067904': '8443',
    '947222279': '8444',
    'RLNK501612286': '8445',
    '2936073559': '8469',
    '5043409': '8470',
    '6438485': '8471',
    '9081213': '8474',
    'APC501637471': '8479',
    'APC501638477': '8488',
    '0000203525': '8491',
    '12495CV9': '8494',
    'W1277309': '8497',
    '175883OI': '8500',
    '11846CV3': '8504',
    '8038693': '8507',
    'APC501612615': '8508',
    'W1277121': '8517',
    'PAB142980': '8518',
    '2936073183': '8521',
    '11811CV4': '8529',
    'E08989051': '8542',
    '176888OI': '8545',
    '5839719': '8557',
    'PAB143354': '8559',
    '8411010': '8570',
    'PAB143557': '8571',
    'W1278634': '8575',
    'APC501643679': '8579',
    '5738463': '8581',
    '7297151': '8587',
    'W1277919': '8590',
    '1-6239967320': '8594',
    '6106133101': '8601',
    '2936075214': '8614',
    'E09026610': '8626',
    '2015-0036469-2': '8630',
    '5044096': '8631',
    '7931960': '8635',
    'W1277412': '8639',
    '2936073871': '8643',
    'APC501634426': '8644',
    'JNeurosci01656': '8654',
    'E09051663': '8656',
    '2936073918': '8660',
    '1-6292395747': '8663',
    'PAB144574': '8676',
    'E09042866': '8683',
    '736198': '8685',
    '5849288': '8686',
    '8228943': '8688',
    '1078': '8691',
    'W1278996': '8695',
    'APC501639497': '8696',
    'APC501639492': '8697',
    '736215': '8703',
    '6106138431': '8712',
    '6438493': '8715',
    '176580OI': '8716',
    'APC501637261': '8726',
    '7776': '8730',
    '2936074316': '8732',
    '176809OI': '8734',
    'E09046897': '8743',
    'W1278420': '8746',
    '736199': '8748',
    'CELR-38773-0': '8752',
    'RLNK501614649': '8761',
    '1-6348307768': '8762',
    'PAB144002': '8766',
    '177607OI': '8771',
    'W1278456': '8776',
    '6031215': '8777',
    '736192': '8792',
    'APC501668285': '8798',
    '15-225': '8803',
    'W1279140': '8806',
    '91311067': '8823',
    'CELR-38766-2': '8838',
    '1338372': '8851',
    '9081214': '8852',
    'W1279208': '8861',
    'W1280718': '8867',
    'E09844068': '8873',
    'APC501652845': '8882',
    'W1279474': '8888',
    '153647': '8894',
    'W1279673': '8897',
    '736282': '8898',
    'PAB140627': '8919',
    'E09084572': '8924',
    'PAB143935': '8925',
    '943196278': '8936',
    '1643725': '8937',
    '8040120': '8957',
    '9713365': '8961',
    'PAB143797': '8966',
    'APC501636720': '8969',
    '8470886': '8975',
    'PAB146323': '8978',
    'APC501637064': '8984',
    '5044520': '8985',
    '7215157': '8991',
    'CELR-38648-0': '8993',
    '1998573': '8995',
    'PAB145395': '9000',
    '11896CV2': '9002',
    '2936075310': '9019',
    '1-6297863601': '9020',
    '2936074263': '9023',
    'E09093943': '9027',
    '11910CV7': '9034',
    '6106134973': '9036',
    'PAB146065': '9037',
    'APC501639718': '9038',
    'W1281461': '9043',
    'APC501649108': '9047',
    'APC501641394': '9093',
    'APC501645195': '9094',
    '5044552': '9099',
    'APC501649078': '9101',
    '178114OI': '9115',
    'W1281383': '9134',
    'W1282980': '9136',
    'W1281774': '9144',
    '6106135376': '9147',
    '11924CV4': '9149',
    'APC501645302': '9152',
    'W1283846': '9156',
    '11537CV8': '9158',
    'E09117134': '9159',
    'E09090484': '9183',
    'E09220131': '9186',
    'PAB146635': '9187',
    '6106135780': '9198',
    '2015 OA 5313': '9202',
    '9351778': '9203',
    'APC501647770': '9206',
    'W1282297': '9216',
    '5045205': '9222',
    '11963CV5': '9237',
    'W1283411': '9239',
    'I0068688': '9240',
    'RLNK501654493': '9241',
    'APC501649516': '9245',
    '736284': '9250',
    '947233250': '9256',
    'W1282757': '9262',
    '2015-385': '9264',
    'CELR-38825-0': '9282',
    'E09127432': '9284',
    'PC 875214': '9035',
    'APC501690152': '9285',
    'APC501651729': '9293',
    'PAB147212': '9297',
    '2015-0037447-4': '9300',
    '178759OI': '9304',
    'W1283161': '9316',
    'E09144210': '9341',
    '943196002': '9357',
    '178637OI': '9364',
    'PAB147076': '9376',
    '11962CV7': '9377',
    '2936075638': '9381',
    'E09140836': '9389',
    'W1284980': '9439',
    'W1284445': '9443',
    '2936075339': '9453',
    '178772OI': '9454',
    'PTP597579002184': '9464',
    '044540': '9465',
    'E09304783': '9467',
    'E09161240': '9470',
    '178968OI': '9471',
    '9243434': '9479',
    'W1284759': '9480',
    'W1288292': '9486',
    '6106137495': '9488',
    '943197792': '9492',
    '12005CV6': '9501',
    'RLNK501662582': '9507',
    '6106135319': '9509',
    '000242949': '9526',
    'APC501666555': '9528',
    'W1284952': '9530',
    'W1289653': '9547',
    '9243436': '9549',
    '44677': '9552',
    'W1285444': '9560',
    'W1287919': '9562',
    '179637OI': '9563',
    '293076207': '9567',
    '258779': '9599',
    '560215': '9601',
    '943199936': '9608',
    '12011CV6': '9613',
    '12029CV1': '9630',
    '12029CV0': '9631',
    'JP116871': '9633',
    '2936078864': '9660',
    '1197756': '9661',
    'APC501678523': '9681',
    '6106143410': '9682',
    'RLNK501685675': '9686',
    '2936076074': '9687',
    '1-6398623879': '9695',
    'W1286737': '9707',
    '91311257': '9711',
    '6106139886': '9718',
    'W1287918': '9720',
    '1119650': '9731',
    'W1286864': '9736',
    '2936076020': '9740',
    '947227882': '9747',
    '2936077374': '9759',
    '180008OI': '9768',
    'ACP-PUC-2015-538': '9769',
    'E09213080': '9779',
    '12088CV0': '9784',
    '6106141373': '9785',
    'PAB150533': '9791',
    '2936076934': '9794',
    '2936076307': '9810',
    'W1287741': '9813',
    'W1287919': '9821',
    'W1288091': '9825',
    '180937OI': '9826',
    '181496OI': '9831',
    'No number': '9832',
    'E09359792': '9833',
    'APC501698274': '9835',
    'W1288090': '9846',
    '180021OI': '9850',
    'W1289048': '9855',
    'PAB150137': '9856',
    '798623': '9858',
    'APC501685888': '9862',
    'W1290370': '9865',
    '2165178': '9874',
    '5045769': '9876',
    'W1290690': '9879',
    'W1289489': '9884',
    '8044258': '9887',
    '947229234': '9889',
    '91314738': '9894',
    '2936076382': '9898',
    '181132OI': '9900',
    '2015-0037888-3': '9901',
    '1333155': '9904',
    'RLNK501682004': '9907',
    '1997617': '9908',
    '1121': '9911',
    '181336OI': '9913',
    '179650OI': '9914',
    'W1288884': '9921',
    '1197766': '9930',
    'PK 886377': '9941',
    'APC501691342': '9953',
    'E09292091': '9956',
    '1474862': '9958',
    '183788OI': '9962',
    '1434292': '9965',
    'PAB151066': '9980',
    'PAB164561': '9983',
    'APC501703619': '9990',
    'W1289846': '9992',
    '1805177': '10006',
    'APC501696258': '10013',
    'PAB151256': '10035',
    'LUP 3983': '10041',
    'PAB151164': '10046',
    '2015-0035487-4': '10048',
    'PAB151484': '10066',
    '180776OI': '10068',
    '12101CV2': '10076',
    '2936077585': '10109',
    'W1294362': '10112',
    '12109CV8': '10115',
    'W1290528': '10116',
    '12053CV5': '10118',
    '3386917': '10124',
    '12111CV5': '10127',
    '8045739': '10131',
    'RG 906346': '10133',
    'PAB151734': '10136',
    '5046377': '10137',
    'PAB152598': '10139',
    '6106141452': '10146',
    'E09314379': '10148',
    '8263': '10150',
    '12286CV2': '10157',
    '8044316': '10159',
    '4770172': '10173',
    '000249184': '10180',
    '91313074': '10181',
    '8044835': '10182',
    '6106141770': '10184',
    'JI-27845-2': '10190',
    '91315582': '10202',
    '736405': '10208',
    '8045743': '10209',
    '000254652': '10218',
    '2781463': '10225',
    '2936078392': '10228',
    '181309OI': '10229',
    '6106144214': '10232',
    '8051053': '10239',
    'W1288353': '10247',
    '12139CV0': '10250',
    'PAB152578': '10254',
    '6106149689': '10256',
    'W1291881': '10259',
    'W1293346': '10260',
    '6106150778': '10276',
    'E09297383': '10278',
    '1000376766': '10280',
    '180998OI': '10296',
    'APC501713182': '10311',
    '3795078': '10312',
    'E09253671': '10314',
    '12193CV6': '10323',
    'W1293635': '10325',
    '000243823': '10331',
    'W1294661': '10333',
    'RC 888210': '10336',
    'AJCN-4418-0': '10337',
    'PAB152081': '10339',
    '5046687': '10349',
    '159338': '10362',
    '182371OI': '10363',
    'biomolecules-86303': '10364',
    '3541705': '10370',
    '184544OI': '10387',
    '8051697': '10401',
    '2936078149': '10407',
    '12202CV2': '10410',
    '185446OI': '10424',
    '000256309': '10431',
    '2015-0034757-5': '10432',
    '12175CV8': '10437',
    'E09179988': '10445',
    '181566OI': '10457',
    '182120OI': '10459',
    '12183CV3': '10462',
    'PAB153501': '10473',
    'E09297215': '10476',
    'W1293978': '10478',
    '736503': '10498',
    'APC501747372': '10503',
    '5688': '10504',
    'I0075247': '10508',
    'W1295958': '10521',
    'JI-27909-2': '10528',
    '8049807': '10531',
    '12210CV0': '10534',
    '2936079044': '10538',
    'PAB156893': '10543',
    '4290357': '10553',
    '2936078958': '10557',
    '12248CV5': '10563',
    '4310478': '10564',
    'E09289701': '10566',
    'W1295129': '10570',
    '12212CV3': '10572',
    'W1294929': '10573',
    'W1297220': '10575',
    'APC501745673': '10583',
    '7465203': '10586',
    'W1308786': '10596',
    '12214CV9': '10598',
    'PAB154533': '10620',
    'RLNK501726587': '10624',
    '6106146065': '10647',
    'W1295496': '10653',
    '12275CV5': '10723',
    '183220OI': '10729',
    '91312564': '10730',
    'apc501728368': '10738',
    '6106145014': '10756',
    'PAB155178': '10757',
    '2936079793': '10760',
    '11850CV4': '10740',
    'E09290357': '10771',
    '12253CV6': '10774',
    'APC501761432': '10792',
    'RLNK501778345': '10794',
    'W1296324': '10811',
    'W1297289': '10821',
    'RLNK501731969': '10827',
    '2149738': '10829',
    '259549': '10834',
    '947234774': '10836',
    '166462': '10840',
    '2015-0041085-4': '10851',
    'W1297919': '10859',
    'W1297920': '10860',
    '184038OI': '10867',
    'APC501739532': '10869',
    'RLNK501735488': '10875',
    '12270CV4': '10878',
    '256325': '10882',
    'W1297022': '10883',
    '12551CV1': '10885',
    'W1297023': '10886',
    '182620OI': '10887',
    'W1296851': '10893',
    '12271CV3': '10894',
    'APC501761991': '10897',
    '7580253': '10898',
    'RLNK501746541': '10902',
    '8048446': '10923',
    '183838OI': '10931',
    '000264051': '10932',
    'PAB155428': '10938',
    '947236792': '10949',
    '736493': '10951',
    '2908446941': '10968',
    'E09314370': '10988',
    'W1297909': '11003',
    '12306CV4': '11017',
    '10062015_HAUAPC_PH': '11022',
    '5896863': '11052',
    'W1298091': '11054',
    'PAB155852': '11066',
    '12282CV4': '11070',
    '7580254': '11079',
    'RLNK501752336': '11095',
    '187215OI': '11101',
    'APC501757398': '11108',
    '8369': '11111',
    '736606': '11113',
    'E09313566': '11116',
    'PAB156468': '11119',
    '6106154006': '11123',
    'PAB156593': '11125',
    'KA 906518': '11141',
    '09282015_HAUAPC': '11145',
    'PAB154838': '11158',
    '2015-0040250-3': '11166',
    'RLNK501747301': '11167',
    'CELR-39136-0': '11182',
    '91312546': '11195',
    '947239958': '11217',
    '91314452': '11223',
    '1075910': '11227',
    '12306CV7': '11231',
    'W12995503': '11234',
    '1000389937': '11238',
    '943204978': '11239',
    '12312CV4': '11224',
    '184798OI': '11254',
    'W1300582': '11266',
    'W1305479': '11278',
    'PTP604439001947': '11286',
    '6106151689': '11288',
    'CELR-39180-0': '11296',
    '257781': '11306',
    'W1302207': '11307',
    'W1300844': '11308',
    '947239085': '11310',
    'APC501756511': '11316',
    '12332CV7': '11318',
    '185213OI': '11326',
    'W1300765': '11332',
    'E09366904': '11333',
    'W1309266': '11335',
    'W1301761': '11349',
    'PAB157427': '11351',
    'APC501772174': '11353',
    'PAB157658': '11390',
    'APC501773198': '11393',
    '8053512': '11394',
    '7580252': '11403',
    '241551': '11413',
    '6106157664': '11414',
    '7580258': '11433',
    'W1305137': '11436',
    'E09343160': '11438',
    'APC501767342': '11442',
    '1124912': '11463',
    'E09357742': '11464',
    'PAB158986': '11465',
    'W1301985': '11467',
    'W1308788': '11470',
    '187095OI': '11473',
    'APC501767336': '11485',
    'APC501800671': '11490',
    'APC501842800': '11500',
    'E09406163': '11519',
    '7580257': '11526',
    'W1302470': '11550',
    'E09351852': '11564',
    'APC501774734': '11565',
    'W1302936': '11584',
    'APC501767448': '11596',
    '12412CV8': '11599',
    '3801219': '11615',
    'W1303439': '11618',
    'W1303605': '11628',
    'JNeurosci02221': '11643',
    'PAB158334': '11647',
    '2149767': '11649',
    '5049264': '11651',
    'E09357712': '11669',
    '8053511': '11674',
    '736573': '11680',
    'PAB161067': '11694',
    '463429': '11708',
    'APC501769959': '11724',
    'APC501772261': '11727',
    '2015-0042361-4': '11756',
    'CELR-39197-0': '11781',
    '12822CV0': '11783',
    'RG 906421': '11784',
    'W1304101': '11791',
    'AJCN-4422-0': '11803',
    '12403CV1': '11814',
    '91316025': '11820',
    '12412CV9': '11824',
    '12430CV0': '11839',
    '2015-954': '11844',
    'INVOTH-001734': '11863',
    'SK 898310': '11865',
    'W1305076': '11867',
    'E09370354': '11874',
    '5049265': '11883',
    '5183917': '11884',
    '737209': '11906',
    'W1308560': '11914',
    '245002': '11918',
    'W1305254': '11923',
    '9204208': '11928',
    '185497OI': '11933',
    'W1306309': '11937',
    '8050085': '11957',
    '8050084': '11959',
    '2015-0045576-5': '11966',
    'W1305478': '11967',
    'W1309267': '11982',
    'SI37703': '11989',
    '189023OI': '11990',
    '4536691': '11996',
    '6106159461': '11998',
    '165099': '12010',
    '9122804': '12036',
    'sl15782': '12039',
    'PAB160178': '12055',
    '190662OI': '12059',
    '12449CV6': '12061',
    '12344CV8': '12075',
    '9799558': '12102',
    'RLNK501794011': '12108',
    '1000389241': '12115',
    'W1308719': '12121',
    'E09406076': '12163',
    '000267024': '12170',
    '1127332': '12171',
    'PAB160247': '12172',
    '189717OI': '12176',
    '6259868': '12190',
    'W1307383': '12194',
    'FJÂ­19847Â­0': '12198',
    '8480': '12208',
    '612360': '12222',
    '9672597': '12223',
    'APC501794592': '12239',
    'APC501798197': '12243',
    'W1308915': '12253',
    'CELR-39307-0': '12254',
    'W1313016': '12260',
    'SL15781': '12283',
    'PAB171325': '12302',
    'W1309869': '12313',
    '492712': '12322',
    '000262333': '12323',
    '260723': '12324',
    'SW 909946': '12339',
    '10404': '12345',
    '190498OI': '12389',
    '190725OI': '12427',
    '6106160800': '12432',
    'CELR-39216-0': '12433',
    '3458763': '12440',
    'APC501839339': '12441',
    'W1313289': '12451',
    'JNeurosci02404': '12452',
    '91314285': '12456',
    '192653OI': '12459',
    'E09500745': '12461',
    '192494OI': '12470',
    'E09666132': '12473',
    '6106160956': '12475',
    '193289OI': '12477',
    'APC501802518A': '12486',
    'APC501813070': '12493',
    '6041816': '12496',
    'W1310730': '12497',
    '947244311': '12506',
    'W1309098': '12507',
    'RLNK501800516': '12514',
    'W1310538': '12517',
    '192156OI': '12523',
    '6106161494': '12529',
    'e09506455': '12546',
    '612357': '12563',
    'APC501817100': '12565',
    '192172OI': '12576',
    '611093': '12579',
    '192803OI': '12581',
    'CELR-39293-0': '12604',
    '6106161683': '12616',
    '12534CV4': '12621',
    'W1309563': '12633',
    'APC501808007': '12636',
    '191775OI': '12638',
    '736634': '12641',
    'E09572109': '12642',
    '5049607': '12645',
    '12543CV3': '12649',
    'W1314260': '12653',
    'W1312872': '12660',
    '1124253': '12661',
    '6106174669': '12663',
    '12': '12664',
    'PAB165338': '12677',
    'BR-561': '12678',
    '12545CV6': '12690',
    '5049746': '12698',
    '3458761': '12740',
    '6806': '12765',
    'W1312207': '12780',
    '192820OI': '12799',
    'APC501811148': '12802',
    '3039899': '12811',
    'W1312408': '12859',
    'W1312587': '12882',
    '12609CV3': '12885',
    '12609CV4': '12895',
    '6106163564': '12929',
    'viruses-228487/ADDITIONAL': '134327',
    '1014293': '207012',
}
MANUAL_OA2ZD_DICT = {
    'OA-13907':'83033',
    'OA-10518':'36495',
    'OA-13111':'76842',
    'OA-14062':'86232',
    'OA-13919':'83197',
    'OA-14269':'89212'
    }

class Aggregated_breakdown():
    def __init__(self, zd_number=None, rcuk_apc=0, coaf_apc=0, rcuk_other=0, coaf_other=0):
        self.zd_number = zd_number
        self.rcuk_apc = rcuk_apc
        self.coaf_apc = coaf_apc
        self.rcuk_other = rcuk_other
        self.coaf_other = coaf_other

AGGREGATED_PAYMENTS = {
    #TODO: It appears that at present, items listed here make their way into the final report if they match any of the input cufs files. They should only be included if they appear in the main funder file. Fix this
    # # 'ZD 6380 & ZD 6393A' : [
    # #     Aggregated_breakdown(zd_number='174623', coaf_apc=2060.70),
    # #     Aggregated_breakdown(zd_number='229679', rcuk_apc=564.6, coaf_apc=564.6)
    # # ],
    # "Bank chg USD IPO:VE 18151, inv:2018-0128399-0_FRONTIERS MEDIA SA_ZD 189498": [
    #     Aggregated_breakdown(zd_number='183374', coaf_apc=0), # charges already included in breakdown below
    # ],
    # 'ZD 189498': [
    #     Aggregated_breakdown(zd_number='183374', coaf_apc=2342.962),
    #     Aggregated_breakdown(zd_number='189686', rcuk_apc=932.2426, coaf_apc=933.8756),
    #     Aggregated_breakdown(zd_number='189680', rcuk_apc=1081.727, coaf_apc=1083.622),
    # ],
    # 'ZD 223311': [
    #     Aggregated_breakdown(zd_number='225975', rcuk_apc=810.7812, coaf_apc=810.7796),
    #     Aggregated_breakdown(zd_number='225977', coaf_apc=2265.92),
    # ],
}

TOTAL_APC_FIELD = 'Total APC amount'

class CoafFieldsMapping():
    '''
    Mapping of column names in CUFS reports of COAF spending.
    '''
    def __init__(self):
        # self.field_names = extract_csv_header(coaf_paymentsfile, "utf-8")
        self.amount_field = 'Burdened Cost'
        self.invoice_field = 'Invoice'
        self.oa_number =  'Comment'
        self.paydate_field = 'GL Posting Date'
        self.transaction_code = None
        self.source_of_funds = None

class CoafOutputMapping():
    '''
    Mapping of column names for output reports of COAF spending.
    '''
    def __init__(self):
        self.total_apc = 'COAF APC Amount' #Name of field we want the calculated total COAF APC to be stored in
        self.total_other = 'COAF Page, colour or membership amount'  # Name of field we want the total for other costs to be stored in

class RcukFieldsMapping():
    '''
    Mapping of column names in CUFS reports of RCUK spending.
    '''
    def __init__(self):
        # self.field_names = extract_csv_header(rcuk_paymentsfile, "utf-8")
        self.amount_field = 'Amount'
        self.cost_centre = 'CC'
        self.invoice_field = 'Ref 5'
        self.oa_number =  'Description'
        self.paydate_field = 'Posted'
        self.source_of_funds = 'SOF'
        self.transaction_code = 'Tran'

class RgeFieldsMapping():
    '''
    Mapping of column names in CUFS reports produced by the Research Grant Expenditure website:
    http://www.expenditure.admin.cam.ac.uk
    '''
    def __init__(self):
        # self.field_names = extract_csv_header(rcuk_paymentsfile, "utf-8")
        self.amount_field = 'Amount'
        self.invoice_field = 'Invoice'
        self.oa_number = 'Expenditure Comment'
        self.paydate_field = 'Expenditure Item Date'

class RcukOutputMapping():
    '''
    Mapping of column names for output reports of RCUK spending.
    '''
    def __init__(self):
        self.total_apc = 'RCUK APC Amount' #Name of field we want the calculated total RCUK APC to be stored in
        self.total_other = 'RCUK Page, colour or membership amount'  # Name of field we want the total for other costs to be stored in

def invoice_to_zd_number_from_old_internal_sheet(csv_path=None):
    '''
    Parses data from the main sheet of the spreadsheet of payments
    (LST_AllFinancialData_V3_20160721_Main_Sheet.csv) maintained by the OA Team
    to record payments of Open Access tickets received before 01/01/2016 (before all payment data began to
    be recorded in Zendesk) and outputs a dictionary of Invoice numbers : ZD numbers

    This is a one off function to help populate INVOICE2ZD_NUMBER above
    '''

    if not csv_path:
        try:
            csv_path = os.path.join('~', 'OSC-shared-drive', 'OSC', 'DataSources', 'FinanceReports',
                                    'LST_AllFinancialData_V3_20160721_Main_Sheet.csv')
        except Exception as e:
            sys.exit('{}; {}'.format(e, e.args))

    logger.info('Parsing old payment spreadsheet {}'.format(csv_path))
    with open(csv_path) as csvfile:
        reader = csv.DictReader(csvfile)
        for row in reader:
            if row['Invoice Number']:
                print("'{}': '{}',".format(row['Invoice Number'], row['Zendesk Number']))
